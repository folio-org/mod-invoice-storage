{
  "scripts": [
    {
      "run": "after",
      "snippet": "CREATE OR REPLACE VIEW vouchers_view AS SELECT vouchers.id AS id, vouchers.jsonb AS jsonb, COALESCE(acquisitions_unit_assignments.jsonb, '{}'::jsonb) || vouchers.jsonb AS metadata FROM vouchers LEFT JOIN acquisitions_unit_assignments ON (acquisitions_unit_assignments.jsonb -> 'recordId'::text) = (vouchers.jsonb -> 'id'::text);",
      "fromModuleVersion": "1.0"
    },
    {
      "run": "after",
      "snippet": "CREATE OR REPLACE VIEW voucher_lines_view AS SELECT voucher_lines.id AS id, voucher_lines.jsonb AS jsonb, COALESCE(acquisitions_unit_assignments.jsonb, '{}'::jsonb) || voucher_lines.jsonb AS metadata FROM voucher_lines LEFT JOIN acquisitions_unit_assignments ON (acquisitions_unit_assignments.jsonb -> 'recordId'::text) = (voucher_lines.jsonb -> 'voucherId'::text);",
      "fromModuleVersion": "1.0"
    }
  ],
  "tables": [
    {
      "tableName": "invoices",
      "fromModuleVersion": 1.0,
      "withMetadata": true,
      "customSnippetPath": "invoice_number_sequence.sql"
    },
    {
      "tableName": "invoice_lines",
      "fromModuleVersion": 1.0,
      "withMetadata": true,
      "foreignKeys": [
        {
          "fieldName": "invoiceId",
          "targetTable": "invoices"
        }
      ]
    },
    {
      "tableName": "vouchers",
      "fromModuleVersion": 1.0,
      "withMetadata": true,
      "customSnippetPath": "voucher_number_sequence.sql",
      "uniqueIndex": [
        {
          "fieldName": "voucherNumber",
          "tOps": "ADD"
        }
      ],
      "foreignKeys": [
        {
          "fieldName": "invoiceId",
          "targetTable": "invoices"
        }
      ]
    },
    {
      "tableName": "voucher_lines",
      "fromModuleVersion": 1.0,
      "withMetadata": true,
      "foreignKeys": [
        {
          "fieldName": "voucherId",
          "targetTable": "vouchers"
        }
      ]
    },
    {
      "tableName": "acquisitions_unit_assignments",
      "fromModuleVersion": 1.0,
      "withMetadata": true,
      "index": [
        {
          "fieldName": "recordId",
          "tOps": "ADD"
        },
        {
          "fieldName": "acquisitionsUnitId",
          "tOps": "ADD"
        }
      ]
    }
  ]
}
